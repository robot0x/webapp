/*! diaodiao 李彦峰 2016-10-09 */
function update_success(a){if("SUCCESS"!=a.result)return console.log("update invoked but server fail."),console.log(a),!1;var b=$(".zs-box"),c=$("body").attr("id");return $(b).find(".a-fav").text(a.res[c].fav),$(b).find(".a-up").text(a.res[c].up),!0}function doupdate(a){var b={aids:a},c=JSON.stringify(b);jQuery.support.cors=!0,$.ajax({type:"POST",contentType:"application/json",data:c,dataType:"json",url:"http://api.diaox2.com/v1/stat/all",success:update_success,timeout:8e3,error:function(a,b,c){console.log("update failed, with error "+c)}}),console.log("Sent data in get_stat is : "+c)}function get_stat(){var a=[];return a.push(Number($("body").attr("id"))),doupdate(a),!0}function pinchImg(a,b){function c(a,b){return a.currentStyle?a.currentStyle[b]:getComputedStyle(a,null)[b]}if(a&&b){var d;d="img"===b.tagName.toLowerCase()?[b]:b.getElementsByTagName("img");for(var e,f,g,h,i=0,j=d.length,k=[];j>i;i++)e=d[i],f=e.width||c(e,"width"),f!==a&&k.push(e);if(j=k.length)for(i=0;j>i;i++)e=k[i],f=e.width,g=e.height||c(e,"height"),h=f/g,e.width=a,e.height=a/h}}$(function(){function a(a){console.log("callback invoked!");var b,c,d,h=$(".hot-list");$(".success-remove").remove(),$.each(a,function(a,i){a>3||(b=i.url,d=i.thumb,-1==d.indexOf("http")&&(d="http://a.diaox2.com/cms/sites/default/files/"+d),c=b.match(e),c&&c.length?b=c[0].replace(e,g):(c=b.match(f),c&&c.length&&(b=c[0].replace(f,g))),$('<li class="f-l"><a href="'+b+'"><img src="'+i.thumb+'" alt="'+i.title+'" width="144" height="144"><p>'+i.title+"</p></a></li>").appendTo(h))})}function b(){y.toggleClass("disnone"),A.animate({top:-450},function(){A.toggleClass("disnone")})}function c(){var a,b,c=document.body.id;try{c||(b=document.body.className.split("_")[0],b?(c=b*Math.pow(2,32)+ +b,console.log(c)):(a=window.location.href.match(/\d+/g),a&&a.length&&(c=a[a.length-1]))),console.log(c)}catch(d){console.log(d),c=window.location.href}console.log(c),new QRCode(document.getElementById("qrcode"),"http://c.diaox2.com/share/"+c+".html"),E=!0}var d=document,e=/\/view\/app\/\?m=(?:show|zk|scene)&id=(\d+)?(&ch=goodthing)?/i,f=/\/cms\/diaodiao\/articles\/(?:goodthing|firstpage|experience|weekend)\/\d+_(\d+)?\.html/i,g="$1.html",h=navigator.userAgent,i=/iphone|mobile|phone|android|pad/i.test(h);try{i&&document.documentElement.offsetWidth<600&&(window.location.href="http://c.diaox2.com/share/"+document.body.id+".html")}catch(j){console.log(j)}var k=$(".banner-list"),l=k.children().length;1===l?$(".slidesjs-navigation").css("display","none"):k.slidesjs({width:640,height:370,navigation:{active:!1},pagination:{active:!1},play:{active:!1,auto:!0,interval:2e3,swap:!0},effect:{slide:{speed:1800}}});for(var m=document.querySelectorAll(".buy-method-list .method"),n=0,o=m.length;o>n;n++)m[n].addEventListener("click",function(a){a=a||event;var b=a.target||a.srcElement;"A"!==b.tagName&&(location.href=this.dataset.href)},!1);$.ajax({url:"http://c.diaox2.com/view/app/?m=recommend&id="+d.body.className.split("_")[0],type:"GET",cache:!0,dataType:"jsonp",crossDomain:!0,jsonpCallback:"mycb",jsonp:"cb",success:a,error:function(a){console.log("recmmend error!"),console.log(a)}});{var p=d.querySelector(".share-area"),q=p.querySelector(".share-wb"),r=p.querySelector(".share-list"),s=r.querySelector("li.cancle a"),t=d.querySelector(".share-mask"),u=d.querySelector(".share-close"),v=d.querySelector(".share"),w=p.querySelector(".share-wx"),x=d.querySelector(".bottom-share"),y=$(t),z=$(u),A=$(p),B=$(v),C=$(x),D=($(q),$(s));$(w)}$(q).on("click",function(){$(r).animate({left:0}),$(q).addClass("active"),$(w).removeClass("active")}),$(w).on("click",function(){$(r).animate({left:-800}),$(w).addClass("active"),$(q).removeClass("active")});var E=!1;D.on("click",b),y.on("click",b),z.on("click",b),B.on("click",function(){y.toggleClass("disnone"),A.toggleClass("disnone"),!E&&c(),A.animate({top:d.documentElement.scrollTop||d.body.scrollTop+100})}),C.on("click",function(){y.toggleClass("disnone"),A.toggleClass("disnone"),!E&&c(),A.animate({top:d.documentElement.scrollTop||d.body.scrollTop+100})});var F,G=$(".method"),H="tt-ii-pp-s",I=G.find("span");I.hover(function(){F=this.parentNode,$.contains(F,F.querySelector("."+H))||$(F).css({position:"relative","z-index":0}).append("<span class='"+H+"' style='position:absolute;top:-72%;left:25px;width:auto;font-size:14px;z-index:-1;'>"+this.innerHTML+"</span>")},function(){F=this.parentNode,$(F).find("."+H).remove()})}),pinchImg(596,document.querySelector(".article"));