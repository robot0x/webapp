/*! diaodiao 李彦峰 2015-11-06 */
function update_success(a){if("SUCCESS"!=a.result)return console.log("update invoked but server fail."),console.log(a),!1;var b=$(".zs-box"),c=$("body").attr("id");return $(b).find(".a-fav").text(a.res[c].fav),$(b).find(".a-up").text(a.res[c].up),!0}function doupdate(a){var b={aids:a},c=JSON.stringify(b);jQuery.support.cors=!0,$.ajax({type:"POST",contentType:"application/json",data:c,dataType:"json",url:"http://api.diaox2.com/v1/stat/all",success:update_success,timeout:8e3,error:function(a,b,c){console.log("update failed, with error "+c)}}),console.log("Sent data in get_stat is : "+c)}function get_stat(){var a=[];return a.push(Number($("body").attr("id"))),doupdate(a),!0}$(function(){function a(a){console.log("callback invoked!");var b=$(".hot-list");$.each(a,function(a,c){a>3||$('<li class="f-l"><a href="'+c.url.replace(e,g)+'"><img src="'+c.thumb+'" alt="'+c.title+'" width="144" height="144"><p>'+c.title+"</p></a></li>").appendTo(b)})}function a(a){console.log("callback invoked!");var b,c,d,h=$(".hot-list");$(".success-remove").remove(),$.each(a,function(a,i){a>3||(b=i.url,d=i.thumb,-1==d.indexOf("http")&&(d="http://a.diaox2.com/cms/sites/default/files/"+d),c=b.match(e),c&&c.length?b=c[0].replace(e,g):(c=b.match(f),c&&c.length&&(b=c[0].replace(f,g))),$('<li class="f-l"><a href="'+b+'"><img src="'+i.thumb+'" alt="'+i.title+'" width="144" height="144"><p>'+i.title+"</p></a></li>").appendTo(h))})}function b(){C.toggleClass("disnone"),E.animate({top:-450},function(){E.toggleClass("disnone")})}function c(){var a,b,c=document.body.id;try{c||(b=document.body.className.split("_")[0],b?(c=b*Math.pow(2,32)+ +b,console.log(c)):(a=window.location.href.match(/\d+/g),a&&a.length&&(c=a[a.length-1]))),console.log(c)}catch(d){console.log(d),c=window.location.href}console.log(c),new QRCode(document.getElementById("qrcode"),"http://c.diaox2.com/share/"+c+".html"),H=!0}var d=document,e=/\/view\/app\/\?m=(?:show|zk|scene)&id=(\d+)?(&ch=goodthing)?/i,f=/\/cms\/diaodiao\/articles\/(?:goodthing|firstpage|experience|weekend)\/\d+_(\d+)?\.html/i,g="$1.html",h=d.querySelector(".article-banner-container"),i=navigator.userAgent,j=/iphone|mobile|phone|android|pad/i.test(i);try{j&&document.documentElement.offsetWidth<600&&(window.location.href="http://c.diaox2.com/share/"+document.body.id+".html")}catch(k){console.log(k)}if(null!==h){var l,m,n=h.querySelector(".banner-list"),o=n.querySelectorAll("li"),p=o.length,q=1===p,r=0,s=maxZindex=p-1,t=($(n),$(h)),u=t.prev(),v=t.next(),w=t.width();q?(u.remove(),v.remove()):($(o).each(function(a,b){b.style.zIndex=s--}),u.on("click",function(){-1===--r&&(r=p-1),m=o[r],m.style.left=-w+"px",m.style.zIndex=++maxZindex,$(m).animate({left:0})}),v.on("click",function(){++r===p&&(r=0),m=o[r],m.style.left=w+"px",m.style.zIndex=++maxZindex,$(m).animate({left:0})}),l=setInterval(function(){v.trigger("click")},1800),$(".article-banner").hover(function(){clearInterval(l)},function(){l=setInterval(function(){v.trigger("click")},1800)}))}$.ajax({url:"http://c.diaox2.com/view/app/?m=recommend&id="+d.body.className.split("_")[0],type:"GET",cache:!0,dataType:"jsonp",crossDomain:!0,jsonpCallback:"mycb",jsonp:"cb",success:a,error:function(a){console.log("recmmend error!"),console.log(a)}});var x=d.querySelector(".share-area"),y=(x.querySelector(".share-list"),d.querySelector(".share-mask")),z=d.querySelector(".share-close"),A=d.querySelector(".share"),B=d.querySelector(".bottom-share"),C=$(y),D=$(z),E=$(x),F=$(A),G=$(B),H=!1;C.on("click",b),D.on("click",b),F.on("click",function(){C.toggleClass("disnone"),E.toggleClass("disnone"),!H&&c(),E.animate({top:d.documentElement.scrollTop||d.body.scrollTop+100})}),G.on("click",function(){C.toggleClass("disnone"),E.toggleClass("disnone"),!H&&c(),E.animate({top:d.documentElement.scrollTop||d.body.scrollTop+100})});var I,J=$(".method"),K="tt-ii-pp-s",L=J.find("span");L.hover(function(){I=this.parentNode,$.contains(I,I.querySelector("."+K))||$(I).css({position:"relative","z-index":0}).append("<span class='"+K+"' style='position:absolute;top:-72%;left:25px;width:auto;font-size:14px;z-index:-1;'>"+this.innerHTML+"</span>")},function(){I=this.parentNode,$(I).find("."+K).remove()})});